{"version":3,"file":"commands.min.js","sources":["../src/commands.js"],"sourcesContent":["// amd/src/commands.js\n// Tiny Acessibilia Commands (estilo plugin de mídia)\n\nimport {getString} from 'core/str';\nimport {getButtonImage} from 'editor_tiny/utils';\nimport {component, buttonName, menuItemName, iconName, KEYS} from './common';\nimport * as Dialog from './dialog';\n\n// Pré-carrega textos + SVG do ícone (pix/icon.svg).\nconst loadAssets = async () => {\n  const [buttonTitle, menuLabel, iconSvgRaw] = await Promise.all([\n    getString(KEYS.BUTTON_TITLE, component),\n    getString(KEYS.MENU_LABEL, component),\n    getButtonImage('icon', component),\n  ]);\n\n  // Normaliza o retorno do ícone para string.\n  const iconSvg = (typeof iconSvgRaw === 'string')\n    ? iconSvgRaw\n    : (iconSvgRaw?.html ?? iconSvgRaw?.toString?.() ?? '');\n\n  return {buttonTitle, menuLabel, iconSvg};\n};\n\n// Padrão: getSetup() (async) → retorna função (editor)=>{...} síncrona.\nexport const getSetup = async () => {\n  const {buttonTitle, menuLabel, iconSvg} = await loadAssets();\n\n  return (editor) => {\n    // 1) Registrar o ícone SVG no Tiny\n    if (iconSvg) {\n      editor.ui.registry.addIcon(iconName, iconSvg);\n    } else {\n      // Fallback simples caso algo dê errado ao obter o SVG\n      editor.ui.registry.addIcon(iconName, '<svg viewBox=\"0 0 24 24\"><path d=\"M3 5h18v14H3z\"/></svg>');\n    }\n\n    // 2) Botão na toolbar\n    editor.ui.registry.addButton(buttonName, {\n      tooltip: buttonTitle,\n      icon: iconName,\n      onAction: () => Dialog.open(editor),\n    });\n\n    // 3) Item no menubar (Insert)\n    editor.ui.registry.addMenuItem(menuItemName, {\n      text: menuLabel,\n      icon: iconName,\n      onAction: () => Dialog.open(editor),\n    });\n  };\n};\n\nexport default { getSetup };\n"],"names":["getSetup","async","buttonTitle","menuLabel","iconSvg","iconSvgRaw","Promise","all","KEYS","BUTTON_TITLE","component","MENU_LABEL","html","toString","_iconSvgRaw$toString","loadAssets","editor","ui","registry","addIcon","iconName","addButton","buttonName","tooltip","icon","onAction","Dialog","open","addMenuItem","menuItemName","text"],"mappings":"0qCAyBaA,SAAWC,gBAChBC,YAACA,YAADC,UAAcA,UAAdC,QAAyBA,cAjBdH,gEACVC,YAAaC,UAAWE,kBAAoBC,QAAQC,IAAI,EAC7D,kBAAUC,aAAKC,aAAcC,oBAC7B,kBAAUF,aAAKG,WAAYD,oBAC3B,yBAAe,OAAQA,2BAQlB,CAACR,YAAAA,YAAaC,UAAAA,UAAWC,QAJO,iBAAfC,WACpBA,iDACCA,MAAAA,kBAAAA,WAAYO,kDAAQP,MAAAA,yCAAAA,WAAYQ,gDAAZC,0BAAAT,iCAA4B,KAOLU,UAExCC,SAEFZ,QACFY,OAAOC,GAAGC,SAASC,QAAQC,iBAAUhB,SAGrCY,OAAOC,GAAGC,SAASC,QAAQC,iBAAU,4DAIvCJ,OAAOC,GAAGC,SAASG,UAAUC,mBAAY,CACvCC,QAASrB,YACTsB,KAAMJ,iBACNK,SAAU,IAAMC,OAAOC,KAAKX,UAI9BA,OAAOC,GAAGC,SAASU,YAAYC,qBAAc,CAC3CC,KAAM3B,UACNqB,KAAMJ,iBACNK,SAAU,IAAMC,OAAOC,KAAKX,oDAKnB,CAAEhB,SAAAA"}